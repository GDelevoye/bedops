
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>4.1. Visualizing the relationship of SNPs and generic genomic features &#8212; BEDOPS v2.4.36</title>
    <link rel="stylesheet" href="../../_static/better.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="4.2. Collapsing multiple BED files into a master list by signal" href="master-list.html" />
    <link rel="prev" title="4. Usage examples" href="../usage-examples.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  </head><body>
    <header id="pageheader"><h1><a href="../../index.html ">
        BEDOPS v2.4.36
    </a></h1></header>
  <div class="related top">
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="../usage-examples.html" title="Previous document">4. Usage examples</a>
        </li>
        <li>
          <a href="master-list.html" title="Next document">4.2. Collapsing multiple BED files into a master list by signal</a>
          &rarr;
        </li>
    </ul>
  </nav>
  <nav id="breadcrumbs">
    <ul>
      <li><a href="../../index.html">Home</a></li>
      <li>
        <a href="../usage-examples.html">4. Usage examples</a>
      </li> 
    </ul>
  </nav>
  </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="visualizing-the-relationship-of-snps-and-generic-genomic-features">
<h1>4.1. Visualizing the relationship of SNPs and generic genomic features<a class="headerlink" href="#visualizing-the-relationship-of-snps-and-generic-genomic-features" title="Permalink to this headline">¶</a></h1>
<p>We want to visualize how genome-wide association study single nucleotide repeats (GWAS SNPs) relate to other genomic features—in this case, these features are DNaseI-hypersensitive sites (DHSs). We could, instead, look at methylated regions, CpG islands, coding sequence or other genomic features. Normally, we might do this for all sites in the genome, but to reduce the file sizes we only look at a subset of data here and we have taken a subset of the real data for the purposes of demonstration.</p>
<p>Roughly speaking, we considered two classes of SNPs: those which are prostate-related (associated with PSA and prostate cancer) and some not (height). We have some BED files with positions of DNaseI-hypersensitive sites for various tissues: two from prostate (LNCaP and PrEC), the rest from other tissues (CACO2, HEPG2, K562, MCF7).</p>
<p>We will use BEDOPS tools to generate per-tissue DHS counts associated with our SNPs, using <a class="reference external" href="http://www.chibi.ubc.ca/matrix2png/">matrix2png</a> to visualize results as a heatmap.</p>
<div class="section" id="bedops-tools-in-use">
<h2>4.1.1. BEDOPS tools in use<a class="headerlink" href="#bedops-tools-in-use" title="Permalink to this headline">¶</a></h2>
<p>For this example, we use <a class="reference internal" href="../reference/file-management/sorting/sort-bed.html#sort-bed"><span class="std std-ref">sort-bed</span></a> to sort the input SNP data, and <a class="reference internal" href="../reference/statistics/bedmap.html#bedmap"><span class="std std-ref">bedmap</span></a> to count the number of single-base or greater overlaps between a SNP and a tissue-specific DHS. A modified version of this script uses loops and other shell features.</p>
</div>
<div class="section" id="script">
<h2>4.1.2. Script<a class="headerlink" href="#script" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/tcsh -efx</span>

<span class="n">sort</span><span class="o">-</span><span class="n">bed</span> <span class="n">GWAS_SNPs</span><span class="o">.</span><span class="n">bed</span> <span class="o">&gt;</span> <span class="n">GWAS_SNPs</span><span class="o">.</span><span class="n">sorted</span><span class="o">.</span><span class="n">bed</span>
<span class="n">bedmap</span> <span class="o">--</span><span class="n">ec</span> <span class="o">--</span><span class="n">delim</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">--</span><span class="n">bp</span><span class="o">-</span><span class="n">ovr</span> <span class="mi">1</span> <span class="o">--</span><span class="n">echo</span> <span class="o">--</span><span class="n">count</span> <span class="n">GWAS_SNPs</span><span class="o">.</span><span class="n">sorted</span><span class="o">.</span><span class="n">bed</span> <span class="n">LNCaP_DHS</span><span class="o">.</span><span class="n">bed</span> <span class="o">&gt;</span> <span class="n">SNP_DHS_matrix</span><span class="o">.</span><span class="n">bed</span>

<span class="c1"># add PrEC DHS overlap counts to matrix</span>
<span class="n">bedmap</span> <span class="o">--</span><span class="n">ec</span> <span class="o">--</span><span class="n">delim</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">--</span><span class="n">bp</span><span class="o">-</span><span class="n">ovr</span> <span class="mi">1</span> <span class="o">--</span><span class="n">count</span> <span class="n">GWAS_SNPs</span><span class="o">.</span><span class="n">sorted</span><span class="o">.</span><span class="n">bed</span> <span class="n">PrEC_DHS</span><span class="o">.</span><span class="n">bed</span> <span class="o">&gt;</span> <span class="n">counts</span><span class="o">.</span><span class="n">txt</span>
<span class="n">paste</span> <span class="n">SNP_DHS_matrix</span><span class="o">.</span><span class="n">bed</span> <span class="n">counts</span><span class="o">.</span><span class="n">txt</span> <span class="o">&gt;</span> <span class="n">new_SNP_DHS_matrix</span><span class="o">.</span><span class="n">bed</span>
<span class="n">mv</span> <span class="n">new_SNP_DHS_matrix</span><span class="o">.</span><span class="n">bed</span> <span class="n">SNP_DHS_matrix</span><span class="o">.</span><span class="n">bed</span>

<span class="c1"># add CACO2 DHS overlap counts to matrix</span>
<span class="n">bedmap</span> <span class="o">--</span><span class="n">ec</span> <span class="o">--</span><span class="n">delim</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">--</span><span class="n">bp</span><span class="o">-</span><span class="n">ovr</span> <span class="mi">1</span> <span class="o">--</span><span class="n">count</span> <span class="n">GWAS_SNPs</span><span class="o">.</span><span class="n">sorted</span><span class="o">.</span><span class="n">bed</span> <span class="n">CACO2_DHS</span><span class="o">.</span><span class="n">bed</span> <span class="o">&gt;</span> <span class="n">counts</span><span class="o">.</span><span class="n">txt</span>
<span class="n">paste</span> <span class="n">SNP_DHS_matrix</span><span class="o">.</span><span class="n">bed</span> <span class="n">counts</span><span class="o">.</span><span class="n">txt</span> <span class="o">&gt;</span> <span class="n">new_SNP_DHS_matrix</span><span class="o">.</span><span class="n">bed</span>
<span class="n">mv</span> <span class="n">new_SNP_DHS_matrix</span><span class="o">.</span><span class="n">bed</span> <span class="n">SNP_DHS_matrix</span><span class="o">.</span><span class="n">bed</span>

<span class="c1"># add HEPG2 DHS overlap counts to matrix</span>
<span class="n">bedmap</span> <span class="o">--</span><span class="n">ec</span> <span class="o">--</span><span class="n">delim</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">--</span><span class="n">bp</span><span class="o">-</span><span class="n">ovr</span> <span class="mi">1</span> <span class="o">--</span><span class="n">count</span> <span class="n">GWAS_SNPs</span><span class="o">.</span><span class="n">sorted</span><span class="o">.</span><span class="n">bed</span> <span class="n">HEPG2_DHS</span><span class="o">.</span><span class="n">bed</span> <span class="o">&gt;</span> <span class="n">counts</span><span class="o">.</span><span class="n">txt</span>
<span class="n">paste</span> <span class="n">SNP_DHS_matrix</span><span class="o">.</span><span class="n">bed</span> <span class="n">counts</span><span class="o">.</span><span class="n">txt</span> <span class="o">&gt;</span> <span class="n">new_SNP_DHS_matrix</span><span class="o">.</span><span class="n">bed</span>
<span class="n">mv</span> <span class="n">new_SNP_DHS_matrix</span><span class="o">.</span><span class="n">bed</span> <span class="n">SNP_DHS_matrix</span><span class="o">.</span><span class="n">bed</span>

<span class="c1"># add K562 DHS overlap counts to matrix</span>
<span class="n">bedmap</span> <span class="o">--</span><span class="n">ec</span> <span class="o">--</span><span class="n">delim</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">--</span><span class="n">bp</span><span class="o">-</span><span class="n">ovr</span> <span class="mi">1</span> <span class="o">--</span><span class="n">count</span> <span class="n">GWAS_SNPs</span><span class="o">.</span><span class="n">sorted</span><span class="o">.</span><span class="n">bed</span> <span class="n">K562_DHS</span><span class="o">.</span><span class="n">bed</span> <span class="o">&gt;</span> <span class="n">counts</span><span class="o">.</span><span class="n">txt</span>
<span class="n">paste</span> <span class="n">SNP_DHS_matrix</span><span class="o">.</span><span class="n">bed</span> <span class="n">counts</span><span class="o">.</span><span class="n">txt</span> <span class="o">&gt;</span> <span class="n">new_SNP_DHS_matrix</span><span class="o">.</span><span class="n">bed</span>
<span class="n">mv</span> <span class="n">new_SNP_DHS_matrix</span><span class="o">.</span><span class="n">bed</span> <span class="n">SNP_DHS_matrix</span><span class="o">.</span><span class="n">bed</span>

<span class="c1"># add MCF7 DHS overlap counts to matrix</span>
<span class="n">bedmap</span> <span class="o">--</span><span class="n">ec</span> <span class="o">--</span><span class="n">delim</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">--</span><span class="n">bp</span><span class="o">-</span><span class="n">ovr</span> <span class="mi">1</span> <span class="o">--</span><span class="n">count</span> <span class="n">GWAS_SNPs</span><span class="o">.</span><span class="n">sorted</span><span class="o">.</span><span class="n">bed</span> <span class="n">MCF7_DHS</span><span class="o">.</span><span class="n">bed</span> <span class="o">&gt;</span> <span class="n">counts</span><span class="o">.</span><span class="n">txt</span>
<span class="n">paste</span> <span class="n">SNP_DHS_matrix</span><span class="o">.</span><span class="n">bed</span> <span class="n">counts</span><span class="o">.</span><span class="n">txt</span> <span class="o">&gt;</span> <span class="n">new_SNP_DHS_matrix</span><span class="o">.</span><span class="n">bed</span>
<span class="n">mv</span> <span class="n">new_SNP_DHS_matrix</span><span class="o">.</span><span class="n">bed</span> <span class="n">SNP_DHS_matrix</span><span class="o">.</span><span class="n">bed</span>

<span class="c1"># cleanup and sort by disease trait</span>
<span class="n">rm</span> <span class="n">counts</span><span class="o">.</span><span class="n">txt</span>
<span class="n">sort</span> <span class="o">-</span><span class="n">k5d</span> <span class="n">SNP_DHS_matrix</span><span class="o">.</span><span class="n">bed</span> <span class="o">&gt;</span> <span class="n">new_SNP_DHS_matrix</span><span class="o">.</span><span class="n">bed</span>
<span class="n">mv</span> <span class="n">new_SNP_DHS_matrix</span><span class="o">.</span><span class="n">bed</span> <span class="n">SNP_DHS_matrix</span><span class="o">.</span><span class="n">bed</span>

<span class="c1"># condense data fields into matrix2png form</span>
<span class="n">awk</span> <span class="s1">&#39;{print $1&quot;:&quot;$2&quot;-&quot;$3&quot;_&quot;$4&quot;_&quot;$5&quot;_&quot;$6&quot;</span><span class="se">\t</span><span class="s1">&quot;$7&quot;</span><span class="se">\t</span><span class="s1">&quot;$8&quot;</span><span class="se">\t</span><span class="s1">&quot;$9&quot;</span><span class="se">\t</span><span class="s1">&quot;$10&quot;</span><span class="se">\t</span><span class="s1">&quot;$11&quot;</span><span class="se">\t</span><span class="s1">&quot;$12}&#39;</span> <span class="n">SNP_DHS_matrix</span><span class="o">.</span><span class="n">bed</span> <span class="o">&gt;</span> <span class="n">new_SNP_DHS_matrix</span><span class="o">.</span><span class="n">txt</span>
<span class="n">mv</span> <span class="n">new_SNP_DHS_matrix</span><span class="o">.</span><span class="n">txt</span> <span class="n">SNP_DHS_matrix</span><span class="o">.</span><span class="n">txt</span>

<span class="c1"># add header</span>
<span class="n">echo</span> <span class="o">-</span><span class="n">e</span> <span class="s2">&quot;0</span><span class="se">\t</span><span class="s2">LNCaP</span><span class="se">\t</span><span class="s2">PrEC</span><span class="se">\t</span><span class="s2">CACO</span><span class="se">\t</span><span class="s2">HEPG2</span><span class="se">\t</span><span class="s2">K562</span><span class="se">\t</span><span class="s2">MCF7&quot;</span> <span class="o">|</span> <span class="n">cat</span> <span class="o">-</span> <span class="n">SNP_DHS_matrix</span><span class="o">.</span><span class="n">txt</span> <span class="o">&gt;</span> <span class="n">new_SNP_DHS_matrix</span><span class="o">.</span><span class="n">txt</span>
<span class="n">mv</span> <span class="n">new_SNP_DHS_matrix</span><span class="o">.</span><span class="n">txt</span> <span class="n">SNP_DHS_matrix</span><span class="o">.</span><span class="n">txt</span>

<span class="c1"># make heatmap</span>
<span class="n">matrix2png</span> <span class="o">-</span><span class="n">r</span> <span class="o">-</span><span class="n">c</span> <span class="o">-</span><span class="n">g</span> <span class="o">-</span><span class="n">size</span> <span class="mi">16</span><span class="p">:</span><span class="mi">16</span> <span class="o">-</span><span class="n">mincolor</span> <span class="n">yellow</span> <span class="o">-</span><span class="n">midcolor</span> <span class="n">black</span> <span class="o">-</span><span class="n">maxcolor</span> <span class="n">red</span> <span class="o">-</span><span class="n">data</span> <span class="n">SNP_DHS_matrix</span><span class="o">.</span><span class="n">txt</span> <span class="o">&gt;</span> <span class="n">SNP_DHS_matrix</span><span class="o">.</span><span class="n">png</span>
</pre></div>
</div>
</div>
<div class="section" id="discussion">
<h2>4.1.3. Discussion<a class="headerlink" href="#discussion" title="Permalink to this headline">¶</a></h2>
<p>Each use of <a class="reference internal" href="../reference/statistics/bedmap.html#bedmap"><span class="std std-ref">bedmap</span></a> is identical: the options <code class="docutils literal notranslate"><span class="pre">--ec</span> <span class="pre">--delim</span> <span class="pre">&quot;\t&quot;</span> <span class="pre">--bp-ovr</span> <span class="pre">1</span> <span class="pre">--count</span></code> add several settings:</p>
<ul class="simple">
<li>Error checking/correction (<code class="docutils literal notranslate"><span class="pre">--ec</span></code>)</li>
<li>Use of the tab character as a custom field delimiter (<code class="docutils literal notranslate"><span class="pre">--delim</span> <span class="pre">&quot;\t&quot;</span></code>) to make results easier to parse with <code class="docutils literal notranslate"><span class="pre">awk</span></code> further downstream</li>
<li>Manual specification of a single base-pair criteria for overlap (<code class="docutils literal notranslate"><span class="pre">--bp-ovr</span> <span class="pre">1</span></code>, although this is the default)</li>
<li>Using <code class="docutils literal notranslate"><span class="pre">--count</span></code>, counting the number of mapping elements (DHSs) which overlap a reference instance (a given SNP)</li>
</ul>
<p>These results are calculated for each of the seven cell types and collated into matrix form to run through <a class="reference external" href="http://www.chibi.ubc.ca/matrix2png/">matrix2png</a>. We show it here to give an idea of what kind of data <a class="reference internal" href="../reference/statistics/bedmap.html#bedmap"><span class="std std-ref">bedmap</span></a> generates, to help create these quantitative visualizations:</p>
<a class="reference internal image-reference" href="../../_images/SNP_DHS_matrix.png"><img alt="../../_images/SNP_DHS_matrix.png" src="../../_images/SNP_DHS_matrix.png" style="width: 99%;" /></a>
<p>Rows are presented in <a class="reference internal" href="../reference/file-management/sorting/sort-bed.html#sort-bed"><span class="std std-ref">sort-bed</span></a> order. Cells in red show greatest relative number of counts, while yellow shows the least. Examining this heatmap, DHS elements appear to associate with prostate disease-related GWAS SNPs.</p>
<p>To make this clearer, here is the same result, with rows sorted by disease name:</p>
<a class="reference internal image-reference" href="../../_images/SNP_DHS_matrix_diseaseSorted.png"><img alt="../../_images/SNP_DHS_matrix_diseaseSorted.png" src="../../_images/SNP_DHS_matrix_diseaseSorted.png" style="width: 99%;" /></a>
<p>While there are some DHSs associated with non-disease SNPs, the majority accumulate with the prostate SNPs.</p>
</div>
<div class="section" id="downloads">
<h2>4.1.4. Downloads<a class="headerlink" href="#downloads" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>The <a class="reference download internal" download="" href="../../_downloads/fcaea9813df9d3454b3a435c4ee207ec/SNP_DHS_heatmap.tcsh"><code class="xref download docutils literal notranslate"><span class="pre">example</span></code></a> script, after modification to use loops and other shell features.</li>
<li><a class="reference download internal" download="" href="../../_downloads/b7d78e04cfaa3c98322c9b8970ac2868/SNP_DHS_data.tgz"><code class="xref download docutils literal notranslate"><span class="pre">Data</span></code></a> for this example are contained in a tarball (use <code class="docutils literal notranslate"><span class="pre">tar</span> <span class="pre">-xzf</span></code> to extract files).</li>
</ul>
<p>The <a class="reference internal" href="../reference/statistics/bedmap.html#bedmap"><span class="std std-ref">bedmap</span></a> tool can operate directly on Starch-formatted archives. Alternatively, use the <a class="reference internal" href="../reference/file-management/compression/unstarch.html#unstarch"><span class="std std-ref">unstarch</span></a> tool to decompress Starch data files to sorted BED format.</p>
<p>Note that these are not the full datasets that went into the original research, but snippets that should otherwise demonstrate the disease-DHS association phenomenon and the use of parts of the BEDOPS toolset.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo_with_label_v3.png" alt="Logo"/>
            </a></p>
  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">4.1. Visualizing the relationship of SNPs and generic genomic features</a><ul>
<li><a class="reference internal" href="#bedops-tools-in-use">4.1.1. BEDOPS tools in use</a></li>
<li><a class="reference internal" href="#script">4.1.2. Script</a></li>
<li><a class="reference internal" href="#discussion">4.1.3. Discussion</a></li>
<li><a class="reference internal" href="#downloads">4.1.4. Downloads</a></li>
</ul>
</li>
</ul>

<form class="search" action="../../search.html" method="get">
  <input type="text" name="q"
   placeholder="type to search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="related bottom">
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="../usage-examples.html" title="Previous document">4. Usage examples</a>
        </li>
        <li>
          <a href="master-list.html" title="Next document">4.2. Collapsing multiple BED files into a master list by signal</a>
          &rarr;
        </li>
    </ul>
  </nav>
  <nav id="breadcrumbs">
    <ul>
      <li><a href="../../index.html">Home</a></li>
      <li>
        <a href="../usage-examples.html">4. Usage examples</a>
      </li> 
    </ul>
  </nav>
  </div>
  <footer id="pagefooter">&copy; 2011-2019, Shane Neph, Alex Reynolds.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a>
      1.8.5
        with the <a href="http://github.com/irskep/sphinx-better-theme">
          better</a> theme.

  </footer>

  
  </body>
</html>